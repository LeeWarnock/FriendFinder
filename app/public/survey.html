<!DOCTYPE html>
<html>

<head>
    <title>Survey Page</title>
    <!-- boostraps css -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-2.2.3.min.js" integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo=" crossorigin="anonymous"></script>
    <!-- boostrap js -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
</head>

<body>
    <div class="modal fade" id="bestFriendModal" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">YOUR NEW BFF IS:</h4>
                </div>
                <div class="modal-body">
                    <div id="bffName"></div>
                    <div id="bffPhoto"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
    <div class=" container">
        <h1>
            Survey Questions
        </h1>
        <p>
            Pleas fill out the survey questions below.
        </p>
        <hr>
        <h3>
            <strong>About You</strong>
        </h3>
        <h4>
            Name (Required)
        </h4>
        <input type="text" name id="name" class="form-control"></input>
        <h4>
            Link to Photo Image (Required)
        </h4>
        <input type="text" name id="photo" class="form-control"></input>
        <br>
        <hr>
        <h3>
            <strong>Question 1</strong>
        </h3>
        <h4>
            Do you inpulsively buy candy in the checkout line at the grocery store?
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q1' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 2</strong>
        </h3>
        <h4>
            You like turtles.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q2' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 3</strong>
        </h3>
        <h4>
            You like to work in groups rather than alone.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q3' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 4</strong>
        </h3>
        <h4>
            You could eat pizza for dinner everyday for the rest of your life.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q4' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 5</strong>
        </h3>
        <h4>
            The best way to spend money is traveling.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q5' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 6</strong>
        </h3>
        <h4>
            Music is important to you.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q6' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 7</strong>
        </h3>
        <h4>
            The group is more important than yourself.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q7' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 8</strong>
        </h3>
        <h4>
            This questionnaire is too long.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q8' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 9</strong>
        </h3>
        <h4>
            You prefer beer to hard alcohol.
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q9' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <h3>
            <strong>Question 10</strong>
        </h3>
        <h4>
            Life is meaningless and we are just ants floating on a rock in a incomprehensibly large universe. 
        </h4>
        <p>
            (1 = Strongly Disagree, 5 = Strongly Agree)
        </p>
        <select id='q10' class="form-control">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
        </select>
        <br>
        <hr>
        <button type="submit" id='submit' class="btn btn-primary btn-lg">
            Submit!
        </button>
    </div>
    <script type="text/javascript">
    $('#submit').on('click', function() {

        var newFriend = {
            name: $('#name').val(),
            photo: $('#photo').val(),
            scores: [$('#q1').val(), $('#q2').val(), $('#q3').val(), $('#q4').val(), $('#q5').val(), $('#q6').val(), $('#q7').val(), $('#q8').val(), $('#q9').val(), $('#q10').val()]
        };

        console.log(newFriend);

        //Grab URL of site
        var currentURL = window.location.origin;

        var compatabilityArray = [];

        var bestFriend = 40;

        var bff = 0;


        //AJAX post the data to the friends API
        $.post(currentURL + "/api/friends", newFriend, function(res) {

        });

        $.get(currentURL + "/api/friends", function(data) {

            //loops through each API friend
            for (i = 0; i < data.length - 1; i++) {
                var compatabilityScore = 0;

                //console.log(data[i].name);
                //console.log(data.length);



                //loops thru each API friend's scores
                for (j = 0; j < data[i].scores.length; j++) {

                    var difference = 0;
                    //console.log(data[i].scores.length);

                    //finds difference between scores   
                    difference = data[i].scores[j] - newFriend.scores[j];

                    Math.abs(difference)

                    //console.log(difference);

                    //SETS COMPATABILITY SCORE TO DIFFERENCE
                    compatabilityScore = compatabilityScore + difference;
                    //console.log(difference);




                }
                //pushes differences of each score to differenceArray
                compatabilityArray.push(compatabilityScore);
                console.log(compatabilityArray);

            }

            for (l = 0; l < compatabilityArray.length; l++) {
                if (compatabilityArray[l] < bestFriend) {
                    bestFriend = compatabilityArray[l];

                }



            }
            console.log("This is # is the lowest therefore the best match, in the compatabilityArray.")
            console.log(bestFriend);
            console.log("This is index of the best friend in the friends.js array")
            console.log(compatabilityArray.indexOf(bestFriend));

            bff = compatabilityArray.indexOf(bestFriend);

            console.log(data[bff].name);

            $('#bffName').append(data[bff].name);
        });



        $('#bestFriendModal').modal("toggle");

        return false;


    });
    </script>
</body>

</html>
